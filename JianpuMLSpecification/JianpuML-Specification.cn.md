# JianpuML: 简谱标记语言

## 概述

JianpuML 是一个极简的简谱标记语言。JianpuML 专注于记录音符的音高和时值，有意省略了其他音乐元素，如力度、装饰音和重复记号。JianpuML 的主要目标不是作为一个全面表达简谱复杂性的工具，而是加速简谱转换成可以在标准音乐记谱软件中容易解读和使用的格式。

## 设计原则

- **简洁性**：格式简单，易于手写和电子编辑。
- **易读性**：清晰的结构，一眼即可理解乐谱的基本内容。

## 元数据

每个 JianpuML 文件可以包含多个描述乐曲基本信息的元数据字段：

```
Title: 乐曲标题
Composer: 作曲者
Arranger: 编曲者

Key: 调号
TimeSignature: 拍号
Tempo: 每分钟节拍数
DefaultDuration: 默认音符时值（例如，4 表示四分音符）
```

特别是以下字段可以在乐谱中多次修改，以适应乐曲的不同部分：
- Key
- TimeSignature
- Tempo
- DefaultDuration

## 音符表示法与时值

### 音符表示法

- **基本音符**: 数字 `1-7` 直接表示相应的音高。
- **升降号**: `#` 表示升号，`b` 表示降号。例如，`6#` 表示升 6，`3b` 表示降 3。
- **和弦**: 同时演奏的多个音符用逗号连接，例如 `1,5` 表示同时演奏音符 1 和 5。
- **连奏**: 用括号 () 将音符包裹表示连奏。例如，`(3 5 6)` 表示这三个音符连奏。
- **固定调表示**: 除了支持首调的数字表示法，还支持了固定调的字母表示法，在元数据中添加 ```Staff: true``` 便使用CDEFGAB表示绝对音高。从而，JianpuML不仅可以表达简谱，还可以直接表达五线谱。

### 八度表示法

- **高八度**: 音符后的点 `.` 表示该音符高八度演奏，例如 `5.` 表示音符 5 高八度演奏。
- **低八度**: 音符前的点 `.` 表示该音符低八度演奏，例如 `.5` 表示音符 5 低八度演奏。

### 时值表示法

- 每个音符或音符组可以跟随斜杠 `/` 和一个数字或字母来表示时值。
  - **数字**: 数字表示音符类型。例如，`5/4` 表示四分音符。
  - **字母**: 为了方便输入，您也可以使用字母表示更短的音符时值：
    - `a` 代表十六分音符（例如，`5/a`）。
    - `b` 代表三十二分音符（例如，`5/b`）。
    - `c` 代表六十四分音符（例如，`5/c`）。
- **默认时值**: `DefaultDuration` 可以设置为乐谱中最常用的音符时值（例如，4 表示四分音符）。如果音符的时值与默认时值相同，则可以省略时值。此外，`DefaultDuration` 可以在乐谱中多次修改，使不同部分的时值输入更加高效。
- **附点音符**: 使用点 `.` 将音符时值延长一半。例如，`5/4.` 表示附点四分音符，而 `5/a.` 表示附点十六分音符。
- **三连音**: 用方括号 [] 包裹的音符表示三连音。例如，`[1 3 5]` 表示三连音。

## 示例

以下示例展示了 JianpuML 格式的使用，包括音符八度、时值的表示法以及不同部分的分隔：

```
Title: Twinkle Twinkle Variation
Composer: 作曲者
Arranger: 编曲者

Key: D Major
TimeSignature: 4/4
Tempo: 100
DefaultDuration: 4

1 1 5 5 | 6 6 5/2 | 4 4 3 3 | 2 2 1/2 |
1,5 1,5 4 4 | 3 3 2/2 | 1,5 1,5 4 4 | 3 3 2/2 |

DefaultDuration: 8
1 1 1 1 5 5 5 5 | 6 6 6 6 5/2 ｜[ 4 4 4 ] [ 3 3 3 ] | ( 2 2 ) 1/2 |
```

以下示例展示了用 JianpuML 直接表达五线谱:

```
Title: 北京的金山上
Composer: 藏族民歌
Arranger: 单简

Key: F
Staff: true
TimeSignature: 4/4
Tempo: 108
DefaultDuration: 8

A/4 A C. E./4 E. D. | C./4 (D. E.) D./4 (D./a C./a C./a A/a) | (A/2. C./4) | E./4 D. (C./a A/a) C./4 D. E.|
A/4 C. D. (A/4 A/A G/A G/A E/A) | E/1 | A A G E A A G E | A A/A A/A C. E. E. (C./A D./A) (D./A C./A C./A A/A) |
A/2 C. (A/A C./A) D. E. | A (A/A G/A E/4) E G A C. | D. D./A D./A (D./A C./A) (C./A A/A) (A/2 | A/4) (d./a c./a c./a a/a) a a a 0
```
